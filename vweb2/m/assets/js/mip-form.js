(window.MIP=window.MIP||[]).push({name:"mip-form",func:function(){define("mip-form/mip-form",["require","zepto","customElement","util","viewer"],function(t){function e(t){if(t.querySelector('input[type="password"],input[type="file"]'))return console.error("禁止使用password与file输入框"),!1;else return!0}function i(){var t=this.element,e=a(t),i=t.getAttribute("url"),n=t.getAttribute("method"),o=t.getAttribute("target"),s=document.createElement("form");s.action=i,s.method=n,o=o?o:"_blank",s.target=u.isIframed&&"_blank"!==o?"_top":o,t.appendChild(s),c.dom.insert(s,t.children),e.find("form").on("submit",function(e){e.preventDefault(),r.call(t)}),t.addEventListener("keydown",function(t){if(13===t.keyCode)t.preventDefault(),r.call(this)},!1)}function n(t,e){return"must"===t?!(""===e):f[t.toUpperCase()].test(e)}function r(){var t=this,e=!1,i=a(t).find("input, textarea, select"),r="get"===t.getAttribute("method"),o=t.getAttribute("url"),s=o.match("http://"),l="";if(i.map(function(i,r){var o,s=r.getAttribute("validatetype"),u=r.getAttribute("validatetarget"),d=r.getAttribute("validatereg"),f=r.value;if("submit"!==r.type){if("checkbox"===r.type||"radio"===r.type)f=r.checked?r.value:"";if(l+="&"+r.name+"="+f,s){if(d)o=""===f?!1:new RegExp(d).test(f);else o=n(s,f);c.css(a(t).find('div[target="'+u+'"]'),{display:!o?"block":"none"}),e=!o?!0:e}}}),!e)if(window.parent!==window&&s&&r){var u="";if(o.match("\\?"))u=o+l;else l=l.substring(1),u=o+"?"+l;var d={event:"mibm-jumplink",data:{url:u}};window.parent.postMessage(d,"*")}else t.getElementsByTagName("form")[0].submit()}function o(){var t=document.querySelectorAll("input");Array.prototype.forEach.call(t,function(t,e){t.addEventListener("focus",function(){s("focus")},!1),t.addEventListener("blur",function(){s("blur")},!1)})}function s(t){if(d)u.sendMessage("input-"+t,{})}var a=t("zepto"),l=t("customElement").create(),c=t("util"),u=t("viewer"),d=u.isIframed,f={EMAIL:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,PHONE:/^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|17[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/,IDCAR:/^\d{15}|\d{18}$/};return l.prototype.build=function(){function t(t){t.stopPropagation(),t.preventDefault();var e=t.target.getAttribute("name"),i=d.parentNode.querySelector('input[name="'+e+'"]');i.focus(),i.value="",c.css(d,{display:"none"})}var n=this.element,r=n.hasAttribute("clear");if(this.cross=null,e(n))i.call(this);if(r){var s=["text","input","datetime","email","number","search","tel","url"],a="";for(var l in s)a+=",input[type="+s[l]+"]";a=a.slice(1);var u=n.querySelectorAll(a);if(!u.length)return;var d=document.createElement("div");d.id="mip-form-cross",this.cross=d;for(var f=0;f<u.length;f++){var p=u[f].offsetHeight;u[f].addEventListener("focus",function(){var t=this;if(d.setAttribute("name",t.getAttribute("name")),c.css(d,{top:t.offsetTop+(p-16)/2-8+"px",left:t.offsetWidth-32+"px"}),t.parentNode.appendChild(d),""!==t.value)c.css(d,{display:"block"});else c.css(d,{display:"none"}),t.oninput=function(){if(!(c&&c.platform&&c.platform.isAndroid()&&"search"===t.type))c.css(d,{display:""!==t.value?"block":"none"})}},!1),u[f].addEventListener("blur",function(){c.css(d,{display:"none"})},!1)}d.addEventListener("touchstart",t,!1),d.addEventListener("mousedown",t,!1),d.addEventListener("click",t,!1)}o()},l}),define("mip-form",["mip-form/mip-form"],function(t){return t}),function(){function t(t,e){t.registerMipElement("mip-form",e,"mip-form{position:relative}mip-form #mip-form-cross{position:absolute;display:block;padding:6px;width:20px;height:20px;right:0;background:url(//m.baidu.com/static/search/clear.png) no-repeat center;z-index:100;background-size:100% 100%;background-origin:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0.4);tap-highlight-color:rgba(0,0,0,0.4)}mip-form input,mip-form textarea,mip-form select{border:1px solid #f1f1f1;padding:6px;display:block;box-sizing:border-box;-webkit-box-sizing:border-box;resize:none;font-size:16px}mip-form input[type='text'],mip-form input[type='input'],mip-form input[type='datetime'],mip-form input[type='email'],mip-form input[type='number'],mip-form input[type='tel'],mip-form input[type='url']{padding-right:30px}mip-form input[type='radio']{display:inline}mip-form label{display:block}mip-form div{display:none;color:#ec1f5c;font-size:12px;text-align:left;padding:0 10% 0 3%}mip-form input[type='submit']{border:1px solid #f1f1f1;border-radius:5px;color:#333;background-color:#d8d7d7}")}if(window.MIP)require(["mip-form"],function(e){t(window.MIP,e)});else require(["mip","mip-form"],t)}()}});